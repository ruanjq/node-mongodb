"use strict";function _interopRequireDefault(o){return o&&o.__esModule?o:{default:o}}Object.defineProperty(exports,"__esModule",{value:!0});var _collections=require("./models/collections"),_collections2=_interopRequireDefault(_collections),mongoose=require("mongoose"),express=require("express"),session=require("express-session"),MongoStore=require("connect-mongo")(session),autoIncrement=require("mongoose-auto-increment"),db=mongoose.connection;autoIncrement.initialize(db);var db_config={DATABASE:"windhome",USER:"windhome",PWD:"windhome",HOSTS:"127.0.0.1",PORT:"27017",DB_CONN_STR:function(){return"mongodb://"+this.USER+":"+this.PWD+"@"+this.HOSTS+":"+this.PORT+"/"+this.DATABASE}};db.on("error",function(o){console.error.bind(console,"... connection error ..."),mongoose.disconnect()}),db.once("open",function(){console.info("... db open ...")}),mongoose.connection.openUri(db_config.DB_CONN_STR()),db.mongoStore=new MongoStore({url:db_config.DB_CONN_STR(),collection:_collections2.default.session}),exports.default=db;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiLmNvbmZpZy5qcyJdLCJuYW1lcyI6WyJfY29sbGVjdGlvbnMiLCJyZXF1aXJlIiwibW9uZ29vc2UiLCJleHByZXNzIiwic2Vzc2lvbiIsIk1vbmdvU3RvcmUiLCJhdXRvSW5jcmVtZW50IiwiZGIiLCJjb25uZWN0aW9uIiwiaW5pdGlhbGl6ZSIsIlBPUlQiLCJEQl9DT05OX1NUUiIsInRoaXMiLCJVU0VSIiwiUFdEIiwiSE9TVFMiLCJEQVRBQkFTRSIsIm9uIiwiZGJfY29uZmlnIiwiYmluZCIsImNvbnNvbGUiLCJkaXNjb25uZWN0Iiwib3BlblVyaSIsIm9uY2UiLCJjb2xsZWN0aW9uIiwiX2NvbGxlY3Rpb25zMiIsImRlZmF1bHQiXSwibWFwcGluZ3MiOiI0SUFNQSxJQUFBQSxhQUFBQyxRQUFBLDJFQUxNQyxTQUFXRCxRQUFRLFlBQ25CRSxRQUFVRixRQUFRLFdBQ2xCRyxRQUFhSCxRQUFRLG1CQUNyQkksV0FBYUosUUFBUSxnQkFBUkEsQ0FBeUJHLFNBQ3RDRSxjQUFnQkwsUUFBUSwyQkFLMUJNLEdBQUtMLFNBQVNNLFdBQ2xCRixjQUFjRyxXQUFXRixJQVZ6QixJQUFNTCxXQUNBQyxTQUFVRixXQUNWRyxLQUFBQSxXQUNBQyxJQUFBQSxXQUNBQyxNQUFBQSxZQVlGSSxLQUFNLFFBQ05DLFlBakJhVixXQU9qQixNQUFBLGFBQUFXLEtBQUFDLEtBQUEsSUFBQUQsS0FBQUUsSUFBQSxJQUFBRixLQUFBRyxNQUFBLElBQUFILEtBQUFGLEtBQUEsSUFBQUUsS0FBQUksV0FJQVQsR0FBQVUsR0FBTUMsUUFBQUEsU0FBQUEsR0FDRkYsUUFBQUEsTUFBVUcsS0FBQUMsUUFESSw0QkFFZFAsU0FBTVEsZUFHTlgsR0FBQUEsS0FBQUEsT0FBTSxXQUNOQyxRQUFBQSxLQU5jLHFCQUFBVCxTQUFsQk0sV0FBQWMsUUFBQUosVUFBQVAsZUFnQkFKLEdBQUdnQixXQUFhLElBQUFsQixZQUNaZSxJQUFBQSxVQUFhVCxjQURqQmEsV0FBQUMsY0FBQUMsUUFBQXRCLDBCQWdCZUciLCJmaWxlIjoiZGIuY29uZmlnLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXHJcbmNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZSgnbW9uZ29vc2UnKTtcclxuY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoXCJleHByZXNzXCIpO1xyXG5jb25zdCBzZXNzaW9uICAgID0gcmVxdWlyZSgnZXhwcmVzcy1zZXNzaW9uJyk7XHJcbmNvbnN0IE1vbmdvU3RvcmUgPSByZXF1aXJlKCdjb25uZWN0LW1vbmdvJykoc2Vzc2lvbik7XHJcbmNvbnN0IGF1dG9JbmNyZW1lbnQgPSByZXF1aXJlKCdtb25nb29zZS1hdXRvLWluY3JlbWVudCcpO1xyXG5pbXBvcnQgQ09MTEVDVElPTlMgZnJvbSBcIi4vbW9kZWxzL2NvbGxlY3Rpb25zXCI7XHJcblxyXG4vLyDorr7nva7lhajlsYBwcm9taXNlIO+8jOmYsuatom1vbmdvb3NlIHByb21pc2Ug5oql6ZSZXHJcbi8vIG1vbmdvb3NlLlByb21pc2UgPSBnbG9iYWwuUHJvbWlzZTtcclxubGV0IGRiID0gbW9uZ29vc2UuY29ubmVjdGlvbjtcclxuYXV0b0luY3JlbWVudC5pbml0aWFsaXplKGRiKTtcclxuY29uc3QgZGJfY29uZmlnID0ge1xyXG4gICAgREFUQUJBU0U6IFwid2luZGhvbWVcIixcclxuICAgIFVTRVI6IFwid2luZGhvbWVcIixcclxuICAgIFBXRDogXCJ3aW5kaG9tZVwiLFxyXG4gICAgSE9TVFM6ICcxMjcuMC4wLjEnLFxyXG4gICAgUE9SVDogXCIyNzAxN1wiLFxyXG4gICAgREJfQ09OTl9TVFIoKSB7XHJcbiAgICAgICAgcmV0dXJuIGBtb25nb2RiOi8vJHt0aGlzLlVTRVJ9OiR7dGhpcy5QV0R9QCR7dGhpcy5IT1NUU306JHt0aGlzLlBPUlR9LyR7dGhpcy5EQVRBQkFTRX1gO1xyXG4gICAgfVxyXG59XHJcblxyXG5kYi5vbignZXJyb3InLCBlcnJvciA9PntcclxuICAgIGNvbnNvbGUuZXJyb3IuYmluZChjb25zb2xlLCAnLi4uIGNvbm5lY3Rpb24gZXJyb3IgLi4uJyk7XHJcbiAgICBtb25nb29zZS5kaXNjb25uZWN0KCk7XHJcbn0pO1xyXG5cclxuZGIub25jZSgnb3BlbicsIGZ1bmN0aW9uIGNhbGxiYWNrKCkge1xyXG4gICAgY29uc29sZS5pbmZvKFwiLi4uIGRiIG9wZW4gLi4uXCIpO1xyXG59KTtcclxuXHJcbm1vbmdvb3NlLmNvbm5lY3Rpb24ub3BlblVyaShkYl9jb25maWcuREJfQ09OTl9TVFIoKSk7XHJcblxyXG5cclxuXHJcbi8vIGNsb3NlIGRiLmNsb3NlKClcclxuXHJcbi8vIHNlc3Npb24gc3RvcmVcclxuZGIubW9uZ29TdG9yZSA9IG5ldyBNb25nb1N0b3JlKHtcclxuICAgIHVybDogZGJfY29uZmlnLkRCX0NPTk5fU1RSKCksXHJcbiAgICBjb2xsZWN0aW9uOiBDT0xMRUNUSU9OUy5zZXNzaW9uXHJcbn0pXHJcblxyXG5leHBvcnQgZGVmYXVsdCBkYjsiXX0=
