"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(exports,"__esModule",{value:!0});var _interceptor=require("../interceptor"),_interceptor2=_interopRequireDefault(_interceptor),_user_ctrl=require("../controllers/user_ctrl"),_home_ctrl=require("../controllers/home_ctrl"),_menu_ctrl=require("../controllers/menu_ctrl"),_hero_ctrl=require("../controllers/hero_ctrl"),router=function(e,r){e.use(function(e,r,t){r.setHeader("Access-Control-Allow-Origin","*"),r.setHeader("Access-Control-Allow-Methods","GET, POST, OPTIONS, PUT, PATCH, DELETE"),r.removeHeader("X-Powered-By"),r.setHeader("Access-Control-Allow-Headers","X-Requested-With,content-type"),r.setHeader("Access-Control-Allow-Credentials",!0),e.session.user&&(r.locals.user=e.session.user),t()}),e.get("/",_interceptor2.default.authorize,function(e,r,t){(0,_home_ctrl.home)(e,r,t,"index")}),e.post("/add/user",_user_ctrl.signup),e.post("/signin",_user_ctrl.login),e.get("/logout",_user_ctrl.logout),e.get("/user/list",_interceptor2.default.authorize,function(e,r,t){(0,_user_ctrl.findAllUser)(e,r,t,"user_list")}),e.get("/user/remove/:id",_interceptor2.default.authorize,_user_ctrl.deleteUser),e.get("/user/login",function(e,r,t){r.render("login_signin",{title:"用户登录"})}),e.get("/user/signup",function(e,r,t){r.render("login_registration",{title:"用户注册"})}),e.get("/menu/list",_interceptor2.default.authorize,function(e,r,t){(0,_menu_ctrl.getAllMenu)(e,r,t,"menu_list")}),e.get("/menu/add",_interceptor2.default.authorize,function(e,r,t){r.render("menu_add",{title:"添加菜单"})}),e.post("/menu/add",_interceptor2.default.authorize,function(e,r,t){(0,_menu_ctrl.saveMenu)(e,r,t)}),e.get("/menu/remove/:id",_interceptor2.default.authorize,_menu_ctrl.deleteMenu),e.get("/hero/list",_hero_ctrl.queryAll),e.get("/hero/search",_hero_ctrl.queryByKeywords),e.get("/hero/detail/:id",_hero_ctrl.queryById),e.post("/hero/detail/:id",_hero_ctrl.updateById),e.post("/hero/add",_hero_ctrl.addHero),e.delete("/hero/remove/:id",_hero_ctrl.deleteById),e.get("*",function(e,r){r.render("utilities_error_404",{status:404,title:"404 Not a Found"})}),r.use("/",e)};exports.default=router;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJvdXRlcy9yb3V0ZXIuY29uZmlnLmpzIl0sIm5hbWVzIjpbIl9pbnRlcmNlcHRvciIsInJlcXVpcmUiLCJfdXNlcl9jdHJsIiwiX2hvbWVfY3RybCIsIl9tZW51X2N0cmwiLCJfaGVyb19jdHJsIiwicm91dGVyIiwiYXBwIiwidXNlIiwicmVxIiwicmVzIiwibmV4dCIsInNldEhlYWRlciIsInJlbW92ZUhlYWRlciIsInVzZXIiLCJsb2NhbHMiLCJzZXNzaW9uIiwiZ2V0IiwiX2ludGVyY2VwdG9yMiIsImRlZmF1bHQiLCJhdXRob3JpemUiLCJwb3N0Iiwic2lnbnVwIiwibG9naW4iLCJsb2dvdXQiLCJkZWxldGVVc2VyIiwidGl0bGUiLCJnZXRBbGxNZW51IiwicmVuZGVyIiwic2F2ZU1lbnUiLCJkZWxldGVNZW51IiwicXVlcnlBbGwiLCJxdWVyeUJ5S2V5d29yZHMiLCJ1cGRhdGVCeUlkIiwiYWRkSGVybyIsImRlbGV0ZSIsImRlbGV0ZUJ5SWQiXSwibWFwcGluZ3MiOiI0SUFBQSxJQUFBQSxhQUFBQyxRQUFBLHFFQUVBQyxXQUFBRCxRQUFBLDRCQUNBRSxXQUFBRixRQUFBLDRCQUNBRyxXQUFBSCxRQUFBLDRCQUNBSSxXQUFBSixRQUFBLDRCQUxBSyxPQUFBLFNBQUFBLEVBQUFDLEdBUUlELEVBQU9FLElBQUksU0FBQ0MsRUFBS0MsRUFBS0MsR0FHbEJELEVBQUlFLFVBQVUsOEJBQStCLEtBUHJERixFQUFBRSxVQUFBLCtCQUFBLDBDQVdRRixFQUFJRyxhQUFhLGdCQUVqQkgsRUFBSUUsVUFBVSwrQkFBZ0MsaUNBSTlDRixFQUFJRSxVQUFVLG9DQUFvQyxHQVY5Q0EsRUFBQUEsUUFBVUUsT0FlVkosRUFBSUssT0FBT0QsS0FBT0wsRUFBSU8sUUFBUUYsTUFabENKLE1BTUFKLEVBQUFXLElBQUEsSUFBQUMsY0FBQUMsUUFBQUMsVUFBQSxTQUFBWCxFQUFBQyxFQUFBQyxJQUNBRCxFQUFBQSxXQUFBQSxNQUFJRSxFQUFBQSxFQUFVRCxFQUFBLFdBSWRMLEVBQUFlLEtBQVFMLFlBQVJkLFdBQUFvQixRQUVDaEIsRUFBQWUsS0FBQSxVQUFBbkIsV0FBQXFCLE9BR0pqQixFQXRCRFcsSUFBQSxVQXNCQ2YsV0FBQXNCLFFBR0RsQixFQUFBVyxJQUFBLGFBQUFDLGNBQUFDLFFBQUFDLFVBQUEsU0FBQVgsRUFBQUMsRUFBQUMsSUFDQUwsRUFBQUEsV0FBQUEsYUFBQUcsRUFBZ0JDLEVBQUFDLEVBQUEsZUFjaEJMLEVBQU9XLElBQUksbUJBQW9CQyxjQUFBQyxRQUFZQyxVQUEzQ2xCLFdBQUF1QixZQUVBbkIsRUFBT1csSUFBSSxjQUFlLFNBQUNSLEVBQUtDLEVBQUtDLEdBVnJDTCxFQUFPZSxPQUFLLGdCQUFaSyxNQUFBLFdBY0FwQixFQUFPVyxJQUFJLGVBQWdCLFNBQUNSLEVBQUtDLEVBQUtDLEdBVnRDTCxFQUFPVyxPQUFJLHNCQUFjUyxNQUFBLFdBSXpCcEIsRUFBQUEsSUFBQSxhQUFXWSxjQUFBQyxRQUFvQkMsVUFBQSxTQUFBWCxFQUFZVyxFQUFBQSxJQVl2QyxFQUFBaEIsV0FBQXVCLFlBQVdsQixFQUFLQyxFQUFLQyxFQUFNLGVBUjlCTCxFQUZEVyxJQUFBLFlBQUFDLGNBQUFDLFFBQUFDLFVBQUEsU0FBQVgsRUFBQUMsRUFBQUMsR0FjSUQsRUFBSWtCLE9BQU8sWUFBY0YsTUFBTyxXQVJuQ3BCLEVBRkRlLEtBQUEsWUFBQUgsY0FBQUMsUUFBQUMsVUFBQSxTQUFBWCxFQUFBQyxFQUFBQyxJQWNJLEVBQUFQLFdBQUF5QixVQUFTcEIsRUFBS0MsRUFBS0MsS0FQdEJMLEVBRkRXLElBQUEsbUJBQUFDLGNBQUFDLFFBQUFDLFVBRUNoQixXQUFBMEIsWUFJQXhCLEVBRkRXLElBQUEsYUFFQ1osV0FBQTBCLFVBV0R6QixFQUFPVyxJQUFJLGVBQVhaLFdBQUEyQixpQkFUQTFCLEVBQUFBLElBQU9lLG1CQUFQZixXQUFBQSxXQUNJQSxFQUFBZSxLQUFBLG1CQUFBaEIsV0FBQTRCLFlBQ0gzQixFQUZEZSxLQUFBLFlBRUNoQixXQUFBNkIsU0FXRDVCLEVBQU82QixPQUFPLG1CQUFkOUIsV0FBQStCLFlBTEE5QixFQUFBQSxJQUFBLElBQVcsU0FBWEcsRUFBQUMsR0FDQUosRUFBT1csT0FBSSx1QkFDSkEsT0FBSSxJQUNKSSxNQUFLLHNCQU9SWCxFQUFBQSxJQUFJa0IsSUFBQUEsb0JBZ0JHdEIiLCJmaWxlIjoicm91dGVzL3JvdXRlci5jb25maWcuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaW50ZXJjZXB0b3IgZnJvbSBcIi4uL2ludGVyY2VwdG9yXCI7XHJcblxyXG5pbXBvcnQgeyBzaWdudXAsIGxvZ2luLCBsb2dvdXQsIGZpbmRBbGxVc2VyLCBkZWxldGVVc2VyIH0gZnJvbSBcIi4uL2NvbnRyb2xsZXJzL3VzZXJfY3RybFwiO1xyXG5pbXBvcnQgeyBob21lIH0gZnJvbSBcIi4uL2NvbnRyb2xsZXJzL2hvbWVfY3RybFwiO1xyXG5pbXBvcnQgeyBnZXRBbGxNZW51LCBzYXZlTWVudSwgZGVsZXRlTWVudSB9IGZyb20gXCIuLi9jb250cm9sbGVycy9tZW51X2N0cmxcIjtcclxuaW1wb3J0IHsgcXVlcnlBbGwsIHF1ZXJ5QnlJZCwgdXBkYXRlQnlJZCwgZGVsZXRlQnlJZCwgYWRkSGVybyAscXVlcnlCeUtleXdvcmRzfSBmcm9tIFwiLi4vY29udHJvbGxlcnMvaGVyb19jdHJsXCI7XHJcbmxldCByb3V0ZXIgPSAocm91dGVyLCBhcHApID0+IHtcclxuXHJcbiAgICByb3V0ZXIudXNlKChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gICAgICAgIC8vIOiuvue9rui3qOWfn+ivt+axglxyXG4gICAgICAgIC8vIFdlYnNpdGUgeW91IHdpc2ggdG8gYWxsb3cgdG8gY29ubmVjdFxyXG4gICAgICAgIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbicsICcqJyk7XHJcblxyXG4gICAgICAgIC8vIFJlcXVlc3QgbWV0aG9kcyB5b3Ugd2lzaCB0byBhbGxvd1xyXG4gICAgICAgIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnLCAnR0VULCBQT1NULCBPUFRJT05TLCBQVVQsIFBBVENILCBERUxFVEUnKTtcclxuICAgICAgICByZXMucmVtb3ZlSGVhZGVyKFwiWC1Qb3dlcmVkLUJ5XCIpO1xyXG4gICAgICAgIC8vIFJlcXVlc3QgaGVhZGVycyB5b3Ugd2lzaCB0byBhbGxvd1xyXG4gICAgICAgIHJlcy5zZXRIZWFkZXIoJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnLCAnWC1SZXF1ZXN0ZWQtV2l0aCxjb250ZW50LXR5cGUnKTtcclxuXHJcbiAgICAgICAgLy8gU2V0IHRvIHRydWUgaWYgeW91IG5lZWQgdGhlIHdlYnNpdGUgdG8gaW5jbHVkZSBjb29raWVzIGluIHRoZSByZXF1ZXN0cyBzZW50XHJcbiAgICAgICAgLy8gdG8gdGhlIEFQSSAoZS5nLiBpbiBjYXNlIHlvdSB1c2Ugc2Vzc2lvbnMpXHJcbiAgICAgICAgcmVzLnNldEhlYWRlcignQWNjZXNzLUNvbnRyb2wtQWxsb3ctQ3JlZGVudGlhbHMnLCB0cnVlKTtcclxuXHJcblxyXG4gICAgICAgIC8vIFBhc3MgdG8gbmV4dCBsYXllciBvZiBtaWRkbGV3YXJlXHJcbiAgICAgICAgaWYgKHJlcS5zZXNzaW9uLnVzZXIpIHtcclxuICAgICAgICAgICAgcmVzLmxvY2Fscy51c2VyID0gcmVxLnNlc3Npb24udXNlcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbmV4dCgpO1xyXG5cclxuICAgIH0pO1xyXG5cclxuXHJcbiAgICAvKiBHRVQgaG9tZSBwYWdlLiAqL1xyXG4gICAgcm91dGVyLmdldCgnLycsIGludGVyY2VwdG9yLmF1dGhvcml6ZSwgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgICAgICAgaG9tZShyZXEsIHJlcywgbmV4dCwgXCJpbmRleFwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJvdXRlci5wb3N0KFwiL2FkZC91c2VyXCIsIHNpZ251cCk7XHJcblxyXG4gICAgcm91dGVyLnBvc3QoXCIvc2lnbmluXCIsIGxvZ2luKTtcclxuXHJcbiAgICByb3V0ZXIuZ2V0KFwiL2xvZ291dFwiLCBsb2dvdXQpO1xyXG5cclxuICAgIHJvdXRlci5nZXQoXCIvdXNlci9saXN0XCIsIGludGVyY2VwdG9yLmF1dGhvcml6ZSwgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgICAgICAgZmluZEFsbFVzZXIocmVxLCByZXMsIG5leHQsIFwidXNlcl9saXN0XCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcm91dGVyLmdldChcIi91c2VyL3JlbW92ZS86aWRcIiwgaW50ZXJjZXB0b3IuYXV0aG9yaXplLCBkZWxldGVVc2VyKVxyXG5cclxuICAgIHJvdXRlci5nZXQoXCIvdXNlci9sb2dpblwiLCAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICAgICAgICByZXMucmVuZGVyKFwibG9naW5fc2lnbmluXCIsIHsgdGl0bGU6IFwi55So5oi355m75b2VXCIgfSlcclxuICAgIH0pXHJcblxyXG4gICAgcm91dGVyLmdldChcIi91c2VyL3NpZ251cFwiLCAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICAgICAgICByZXMucmVuZGVyKFwibG9naW5fcmVnaXN0cmF0aW9uXCIsIHsgdGl0bGU6IFwi55So5oi35rOo5YaMXCIgfSlcclxuICAgIH0pXHJcblxyXG5cclxuICAgIHJvdXRlci5nZXQoJy9tZW51L2xpc3QnLCBpbnRlcmNlcHRvci5hdXRob3JpemUsIChyZXEsIHJlcywgbmV4dCkgPT4ge1xyXG4gICAgICAgIGdldEFsbE1lbnUocmVxLCByZXMsIG5leHQsIFwibWVudV9saXN0XCIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcm91dGVyLmdldCgnL21lbnUvYWRkJywgaW50ZXJjZXB0b3IuYXV0aG9yaXplLCAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICAgICAgICByZXMucmVuZGVyKFwibWVudV9hZGRcIiwgeyB0aXRsZTogXCLmt7vliqDoj5zljZVcIiB9KVxyXG4gICAgfSk7XHJcblxyXG4gICAgcm91dGVyLnBvc3QoJy9tZW51L2FkZCcsIGludGVyY2VwdG9yLmF1dGhvcml6ZSwgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbiAgICAgICAgc2F2ZU1lbnUocmVxLCByZXMsIG5leHQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgcm91dGVyLmdldChcIi9tZW51L3JlbW92ZS86aWRcIiwgaW50ZXJjZXB0b3IuYXV0aG9yaXplLCBkZWxldGVNZW51KVxyXG5cclxuXHJcbiAgICAvLyBoZXJvIHJvdWVyXHJcbiAgICByb3V0ZXIuZ2V0KFwiL2hlcm8vbGlzdFwiLCBxdWVyeUFsbCk7XHJcbiAgICByb3V0ZXIuZ2V0KFwiL2hlcm8vc2VhcmNoXCIsIHF1ZXJ5QnlLZXl3b3Jkcyk7XHJcbiAgICByb3V0ZXIuZ2V0KFwiL2hlcm8vZGV0YWlsLzppZFwiLCBxdWVyeUJ5SWQpO1xyXG4gICAgcm91dGVyLnBvc3QoXCIvaGVyby9kZXRhaWwvOmlkXCIsIHVwZGF0ZUJ5SWQpO1xyXG4gICAgcm91dGVyLnBvc3QoXCIvaGVyby9hZGRcIiwgYWRkSGVybyk7XHJcbiAgICByb3V0ZXIuZGVsZXRlKFwiL2hlcm8vcmVtb3ZlLzppZFwiLCBkZWxldGVCeUlkKTtcclxuXHJcblxyXG5cclxuICAgIHJvdXRlci5nZXQoJyonLCBmdW5jdGlvbihyZXEsIHJlcykge1xyXG4gICAgICAgIHJlcy5yZW5kZXIoJ3V0aWxpdGllc19lcnJvcl80MDQnLCB7XHJcbiAgICAgICAgICAgIHN0YXR1czogNDA0LFxyXG4gICAgICAgICAgICB0aXRsZTogJzQwNCBOb3QgYSBGb3VuZCcsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgYXBwLnVzZSgnLycsIHJvdXRlcik7XHJcblxyXG5cclxufVxyXG5cclxuXHJcblxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHJvdXRlcjsiXX0=
