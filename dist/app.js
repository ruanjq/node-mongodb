"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function logErrors(e,r,o,s){console.error(e.stack),s(e)}function clientErrorHandler(e,r,o,s){r.xhr?o.status(500).send({error:"Something failed!"}):s(e)}function errorHandler(e,r,o,s){o.status(500),o.render("error",{error:e})}var _db=require("./db.config"),_db2=_interopRequireDefault(_db),_router=require("./routes/router.config"),_router2=_interopRequireDefault(_router),_tools=require("./tools.fun"),_tools2=_interopRequireDefault(_tools),_config=require("./config/config.dev"),_config2=_interopRequireDefault(_config),express=require("express"),app=express(),path=require("path"),favicon=require("serve-favicon"),cookieParser=require("cookie-parser"),bodyParser=require("body-parser"),session=require("express-session"),ejs=require("ejs"),fs=require("fs"),router=express.Router();app.locals.DOMAIN=_config2.default.DOMAIN,app.locals.user=null,app.locals.toolsFun=_tools2.default,app.set("views",path.join(__dirname,"../static/views")),ejs.delimiter="?",app.engine("html",ejs.renderFile),app.set("view engine","html"),app.use(favicon(path.join(__dirname,"../","favicon.ico"))),app.set("showStackError",!0),app.use(bodyParser.json()),app.use(bodyParser.urlencoded({extended:!0})),app.use(cookieParser()),app.use(bodyParser.json({type:"application/json"})),app.use(bodyParser.raw({type:"application/vnd.custom-type"})),app.use(bodyParser.text({type:"text/html"})),app.use(logErrors),app.use(clientErrorHandler),app.use(errorHandler),app.use(express.static(path.join(__dirname,"../static"))),app.use(session({name:"USER_ID",secret:"windhome_1",store:_db2.default.mongoStore,saveUninitialized:!1,resave:!1,cookie:{maxAge:18e5}})),(0,_router2.default)(router,app),console.log(_config2.default.DOMAIN),app.listen(_config2.default.PORT,_config2.default.DOMAIN,function(){console.log("Listening at http://"+_config2.default.DOMAIN+":"+_config2.default.PORT+" \n")});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6WyJjb25zb2xlIiwibG9nIiwiZXJyIiwicmVxIiwiRE9NQUlOIiwibGlzdGVuIiwiZXJyb3IiLCJzdGFjayIsInJlcyIsIm5leHQiLCJ4aHIiLCJzdGF0dXMiLCJzZW5kIiwiY2xpZW50RXJyb3JIYW5kbGVyIiwicmVuZGVyIiwiX2RiIiwicmVxdWlyZSIsIl9yb3V0ZXIiLCJfdG9vbHMiLCJfY29uZmlnIiwiZXhwcmVzcyIsImFwcCIsInBhdGgiLCJmYXZpY29uIiwiY29va2llUGFyc2VyIiwiYm9keVBhcnNlciIsInNlc3Npb24iLCJlanMiLCJmcyIsInJvdXRlciIsIlJvdXRlciIsImxvY2FscyIsIl9jb25maWcyIiwiZGVmYXVsdCIsIl90b29sczIiLCJfX2Rpcm5hbWUiLCJzZXQiLCJqb2luIiwidXNlIiwidXJsZW5jb2RlZCIsImV4dGVuZGVkIiwiZW5naW5lIiwicmVuZGVyRmlsZSIsInJhdyIsInR5cGUiLCJ0ZXh0IiwibG9nRXJyb3JzIiwic2VjcmV0Iiwic3RvcmUiLCJfZGIyIiwibW9uZ29TdG9yZSIsImVycm9ySGFuZGxlciIsIm1heEFnZSIsIlBPUlQiXSwibWFwcGluZ3MiOiJxRkFnRkFBLFNBQVFDLFVBQUlDLEVBQUFDLEVBQU9DLEVBQUFBLEdBSWZDLFFBQU9DLE1BQUFKLEVBQUFLLE9BQ1BQLEVBQUFBLEdBTUFBLFNBQUFBLG1CQUFBRSxFQUFBQyxFQUFBSyxFQUFBQyxHQUNBQSxFQUFBQyxJQUNIRixFQUFBRyxPQUFBLEtBQUFDLE1BQUFOLE1BQUEsc0JBSURHLEVBQVNJLEdBSURKLFNBQUFBLGFBQUFQLEVBQUFDLEVBQUFLLEVBQUFDLEdBQ0hELEVBQUFHLE9BQUEsS0FDSkgsRUFBQU0sT0FBQSxTQUFBUixNQUFBSixJQTVGRCxJQUFBYSxJQUFBQyxRQUFBLGdEQUVBQyxRQUFBRCxRQUFBLG1FQUVBRSxPQUFBRixRQUFBLHNEQUVBRyxRQUFBSCxRQUFBLGdFQWpCSUksUUFBVUosUUFBUSxXQUNsQkssSUFBTUQsVUFVVkUsS0FBQU4sUUFBQSxRQVJJTyxRQUFVUCxRQUFRLGlCQUNsQlEsYUFBZVIsUUFBUSxpQkFDdkJTLFdBQWFULFFBQVEsZUFRekJVLFFBQUFWLFFBQUEsbUJBTklXLElBQU1YLFFBQVEsT0FDZFksR0FBS1osUUFBUSxNQUNiYSxPQUFTVCxRQUFRVSxTQVVyQlQsSUFBSVUsT0FBTzNCLE9BQVM0QixTQUFBQyxRQUFPN0IsT0FuQjNCaUIsSUFBSUQsT0FBQUEsS0FBVUosS0FDZEssSUFBSUEsT0FBTUQsU0FBVmMsUUFBQUQsUUFHQVosSUFBSUcsSUFBQUEsUUFBQUEsS0FBZVIsS0FBUW1CLFVBQUEsb0JBRzNCUixJQUFJQSxVQUFNWCxJQUVWSyxJQUFJUSxPQUFBQSxPQUFTVCxJQUFRVSxZQXVCckJULElBQUllLElBQUksY0FBZSxRQVp2QmYsSUFBSVUsSUFBQUEsUUFBSlQsS0FBa0JlLEtBQWxCRixVQUFBLE1BQUEsaUJBZ0JBZCxJQUFJZSxJQUFJLGtCQUFrQixHQVoxQmYsSUFBSWUsSUFBSVgsV0FBU0gsUUFlakJELElBQUlpQixJQUFJYixXQUFXYyxZQUFhQyxVQUFVLEtBYjFDbkIsSUFBQWlCLElBQUFkLGdCQUdBSCxJQUFJb0IsSUFBQUEsV0FBZWQsTUFBSWUsS0FBQUEsc0JBR3ZCckIsSUFBSWUsSUFBSVgsV0FBQWtCLEtBQWVDLEtBQXZCLGlDQWlCQXZCLElBQUlpQixJQUFJYixXQUFXb0IsTUFBT0QsS0FBTSxlQWJoQ3ZCLElBQUllLElBQUlVLFdBZVJ6QixJQUFJaUIsSUFBSXpCLG9CQWJSUSxJQUFJaUIsSUFBSWIsY0FFUkosSUFBSWlCLElBQUlkLFFBQUFBLE9BQVJGLEtBQUFlLEtBQUFGLFVBQUEsZUFLQWQsSUFBQWlCLElBQUFaLFNBQ0lZLEtBQUliLFVBZUpzQixPQUFRLGFBYlpDLE1BQUFDLEtBQUFoQixRQUFBaUIsV0FDSVosbUJBQUksRUFDSkEsUUFBSVEsRUFDSlIsUUFDSWEsT0FBQUEsVUFTSkosRUFBQUEsU0FBQUEsU0FBUWxCLE9BQUFSLEtBS0orQixRQUFBQSxJQUFBQSxTQUFBQSxRQUFRaEQsUUFNaEJpQixJQUFBaEIsT0FBQTJCLFNBQUFDLFFBQUFvQixLQUFBckIsU0FBQUMsUUFBQTdCLE9BQUEsV0FhSUosUUFBUUMsSUFBSSx1QkFBeUIrQixTQUFBQyxRQUFPN0IsT0FBUyxJQUFNNEIsU0FBQUMsUUFBT29CLEtBQU8iLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XHJcbnZhciBhcHAgPSBleHByZXNzKCk7XHJcbnZhciBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xyXG52YXIgZmF2aWNvbiA9IHJlcXVpcmUoJ3NlcnZlLWZhdmljb24nKTtcclxudmFyIGNvb2tpZVBhcnNlciA9IHJlcXVpcmUoJ2Nvb2tpZS1wYXJzZXInKTtcclxudmFyIGJvZHlQYXJzZXIgPSByZXF1aXJlKCdib2R5LXBhcnNlcicpO1xyXG52YXIgc2Vzc2lvbiA9IHJlcXVpcmUoJ2V4cHJlc3Mtc2Vzc2lvbicpO1xyXG52YXIgZWpzID0gcmVxdWlyZSgnZWpzJyk7XHJcbnZhciBmcyA9IHJlcXVpcmUoXCJmc1wiKTtcclxudmFyIHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XHJcblxyXG5pbXBvcnQgZGIgZnJvbSBcIi4vZGIuY29uZmlnXCI7XHJcblxyXG5pbXBvcnQgcm91dGVyQ29uZmlnIGZyb20gJy4vcm91dGVzL3JvdXRlci5jb25maWcnO1xyXG4vLyBpbXBvcnQgbG9nQ29uZmlnIGZyb20gJy4vbG9nLmNvbmZpZyc7XHJcbmltcG9ydCB0b29sc0Z1biBmcm9tICcuL3Rvb2xzLmZ1bic7XHJcblxyXG5pbXBvcnQgY29uZmlnIGZyb20gXCIuL2NvbmZpZy9jb25maWcuZGV2XCI7XHJcblxyXG5hcHAubG9jYWxzLkRPTUFJTiA9IGNvbmZpZy5ET01BSU47XHJcbmFwcC5sb2NhbHMudXNlciA9IG51bGw7XHJcbmFwcC5sb2NhbHMudG9vbHNGdW4gPSB0b29sc0Z1bjtcclxuXHJcbi8v6K6+572u5qih5p2/55uu5b2VXHJcbmFwcC5zZXQoJ3ZpZXdzJywgcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uL3N0YXRpYy92aWV3cycpKTtcclxuXHJcbi8vIOiuvue9ruW8leaTjuWQjue8gC4gIGluZGV4Lmh0bWwg5Lit55qE5YaF5a655Y+v5Lul5pivIGVqcyDku6PnoIFcclxuZWpzLmRlbGltaXRlciA9IFwiP1wiO1xyXG5cclxuYXBwLmVuZ2luZSgnaHRtbCcsIGVqcy5yZW5kZXJGaWxlKTtcclxuXHJcbi8vIOiuvue9ruaooeadv+W8leaTjlxyXG5hcHAuc2V0KCd2aWV3IGVuZ2luZScsICdodG1sJyk7XHJcbi8vIHVuY29tbWVudCBhZnRlciBwbGFjaW5nIHlvdXIgZmF2aWNvbiBpbiAvcHVibGljXHJcbmFwcC51c2UoZmF2aWNvbihwYXRoLmpvaW4oX19kaXJuYW1lLCAnLi4vJywgJ2Zhdmljb24uaWNvJykpKTtcclxuXHJcbmFwcC5zZXQoJ3Nob3dTdGFja0Vycm9yJywgdHJ1ZSk7XHJcblxyXG5hcHAudXNlKGJvZHlQYXJzZXIuanNvbigpKTtcclxuYXBwLnVzZShib2R5UGFyc2VyLnVybGVuY29kZWQoeyBleHRlbmRlZDogdHJ1ZSB9KSk7XHJcbmFwcC51c2UoY29va2llUGFyc2VyKCkpXHJcbi8vIOiuvue9ruWTjeW6lOexu+Wei+S4uiBqc29uIOaVsOaNruagvOW8j1xyXG4vLyBwYXJzZSB2YXJpb3VzIGRpZmZlcmVudCBjdXN0b20gSlNPTiB0eXBlcyBhcyBKU09OXHJcbmFwcC51c2UoYm9keVBhcnNlci5qc29uKHsgdHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nIH0pKVxyXG5cclxuLy8gcGFyc2Ugc29tZSBjdXN0b20gdGhpbmcgaW50byBhIEJ1ZmZlclxyXG5hcHAudXNlKGJvZHlQYXJzZXIucmF3KHsgdHlwZTogJ2FwcGxpY2F0aW9uL3ZuZC5jdXN0b20tdHlwZScgfSkpXHJcblxyXG4vLyBwYXJzZSBhbiBIVE1MIGJvZHkgaW50byBhIHN0cmluZ1xyXG5hcHAudXNlKGJvZHlQYXJzZXIudGV4dCh7IHR5cGU6ICd0ZXh0L2h0bWwnIH0pKTtcclxuYXBwLnVzZShsb2dFcnJvcnMpXHJcbmFwcC51c2UoY2xpZW50RXJyb3JIYW5kbGVyKVxyXG5hcHAudXNlKGVycm9ySGFuZGxlcilcclxuLy8g6Z2Z5oCB6LWE5rqQ55uu5b2VXHJcbmFwcC51c2UoZXhwcmVzcy5zdGF0aWMocGF0aC5qb2luKF9fZGlybmFtZSwgJy4uL3N0YXRpYycpKSk7XHJcblxyXG4vLyBjb25zb2xlLmxvZyhcIi0tLS0tLS0tLS1cIixwcm9jZXNzLmVudi5OT0RFX0VOVik7XHJcblxyXG5cclxuYXBwLnVzZShzZXNzaW9uKHtcclxuICAgIG5hbWU6IFwiVVNFUl9JRFwiLFxyXG4gICAgc2VjcmV0OiAnd2luZGhvbWVfMScsIC8vIOeUqOadpeWvuXNlc3Npb24gaWTnm7jlhbPnmoRjb29raWXov5vooYznrb7lkI1cclxuICAgIHN0b3JlOiBkYi5tb25nb1N0b3JlLCAvLyDmnKzlnLDlrZjlgqhzZXNzaW9u77yI5paH5pys5paH5Lu277yM5Lmf5Y+v5Lul6YCJ5oup5YW25LuWc3RvcmXvvIzmr5TlpoJyZWRpc+eahO+8iVxyXG4gICAgc2F2ZVVuaW5pdGlhbGl6ZWQ6IGZhbHNlLCAvLyDmmK/lkKboh6rliqjkv53lrZjmnKrliJ3lp4vljJbnmoTkvJror53vvIzlu7rorq5mYWxzZVxyXG4gICAgcmVzYXZlOiBmYWxzZSwgLy8g5piv5ZCm5q+P5qyh6YO96YeN5paw5L+d5a2Y5Lya6K+d77yM5bu66K6uZmFsc2VcclxuICAgIGNvb2tpZToge1xyXG4gICAgICAgIG1heEFnZTogMzAgKiAxMDAwICogNjAgLy8g5pyJ5pWI5pyf77yM5Y2V5L2N5piv5q+r56eSIDMwIOWIhumSn1xyXG4gICAgfVxyXG59KSk7XHJcblxyXG5cclxuXHJcbi8vIGxvZ0NvbmZpZyhhcHApO1xyXG5cclxuLy8g6YWN572u6Lev55Sx5b+F6aG75pS+5ZyoIOmFjee9rnNlc3Npb24g5ZCO6Z2i77yM5omN6IO95Zyocm91dGVyIHJlcSDlr7nosaHkuK3kvb/nlKhzZXNzaW9uLOWlveWDj+mFsee0q+eahFxyXG5yb3V0ZXJDb25maWcocm91dGVyLGFwcCk7XHJcblxyXG5cclxuXHJcblxyXG5jb25zb2xlLmxvZyhjb25maWcuRE9NQUlOKTtcclxuXHJcblxyXG5cclxuYXBwLmxpc3Rlbihjb25maWcuUE9SVCwgY29uZmlnLkRPTUFJTiwgKCkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coJ0xpc3RlbmluZyBhdCBodHRwOi8vJyArIGNvbmZpZy5ET01BSU4gKyAnOicgKyBjb25maWcuUE9SVCArICcgXFxuJylcclxufSk7XHJcblxyXG5cclxuZnVuY3Rpb24gbG9nRXJyb3JzKGVyciwgcmVxLCByZXMsIG5leHQpIHtcclxuXHJcbiAgICBjb25zb2xlLmVycm9yKGVyci5zdGFjaylcclxuICAgIG5leHQoZXJyKVxyXG59XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIGNsaWVudEVycm9ySGFuZGxlcihlcnIsIHJlcSwgcmVzLCBuZXh0KSB7XHJcbiAgICBpZiAocmVxLnhocikge1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5zZW5kKHsgZXJyb3I6ICdTb21ldGhpbmcgZmFpbGVkIScgfSlcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbmV4dChlcnIpXHJcbiAgICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGVycm9ySGFuZGxlcihlcnIsIHJlcSwgcmVzLCBuZXh0KSB7XHJcbiAgICByZXMuc3RhdHVzKDUwMClcclxuICAgIHJlcy5yZW5kZXIoJ2Vycm9yJywgeyBlcnJvcjogZXJyIH0pXHJcbn0iXX0=
